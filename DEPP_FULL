

## Import

import delimited C:\Users\Antoine\Desktop\DEPP\s97.csv
save "C:\Users\Antoine\Desktop\DEPP\s97.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s98.csv
save "C:\Users\Antoine\Desktop\DEPP\s98.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s99.csv
save "C:\Users\Antoine\Desktop\DEPP\s99.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s00.csv
save "C:\Users\Antoine\Desktop\DEPP\s00.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s01.csv
save "C:\Users\Antoine\Desktop\DEPP\s01.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s02.csv
save "C:\Users\Antoine\Desktop\DEPP\s02.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s03.csv
save "C:\Users\Antoine\Desktop\DEPP\s03.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s04.csv
save "C:\Users\Antoine\Desktop\DEPP\s04.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s05.csv
save "C:\Users\Antoine\Desktop\DEPP\s05.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s06.csv
save "C:\Users\Antoine\Desktop\DEPP\s06.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s07.csv
save "C:\Users\Antoine\Desktop\DEPP\s07.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s08.csv
save "C:\Users\Antoine\Desktop\DEPP\s08.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s09.csv
save "C:\Users\Antoine\Desktop\DEPP\s09.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s10.csv
save "C:\Users\Antoine\Desktop\DEPP\s10.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s11.csv
save "C:\Users\Antoine\Desktop\DEPP\s11.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s12.csv
save "C:\Users\Antoine\Desktop\DEPP\s12.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s13.csv
save "C:\Users\Antoine\Desktop\DEPP\s13.dta"
clear
import delimited C:\Users\Antoine\Desktop\DEPP\s14.csv
save "C:\Users\Antoine\Desktop\DEPP\s14.dta"

## Gestion des incohérences de format 

use "C:\Users\Antoine\Desktop\DEPP\s07.dta"

tab franaistranger

destring franaistranger, replace force
save "C:\Users\Antoine\Desktop\DEPP\s07.dta", replace
use "C:\Users\Antoine\Desktop\DEPP\s08.dta"
destring franaistranger, replace force
save "C:\Users\Antoine\Desktop\DEPP\s08.dta", replace
use "C:\Users\Antoine\Desktop\DEPP\s09.dta"
destring franaistranger, replace force
save "C:\Users\Antoine\Desktop\DEPP\s09.dta", replace
use "C:\Users\Antoine\Desktop\DEPP\s10.dta"
destring franaistranger, replace force
save "C:\Users\Antoine\Desktop\DEPP\s10.dta", replace
use "C:\Users\Antoine\Desktop\DEPP\s11.dta"
destring franaistranger, replace force
save "C:\Users\Antoine\Desktop\DEPP\s11.dta", replace
use "C:\Users\Antoine\Desktop\DEPP\s12.dta"
destring franaistranger, replace force
save "C:\Users\Antoine\Desktop\DEPP\s12.dta", replace
use "C:\Users\Antoine\Desktop\DEPP\s13.dta"
destring franaistranger, replace force
save "C:\Users\Antoine\Desktop\DEPP\s13.dta", replace
use "C:\Users\Antoine\Desktop\DEPP\s14.dta"
destring franaistranger, replace force
save "C:\Users\Antoine\Desktop\DEPP\s14.dta", replace
clear

## Fusion des fichiers par année

use "C:\Users\Antoine\Desktop\DEPP\s97.dta", clear

append using "C:\Users\Antoine\Desktop\DEPP\s98.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s99.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s00.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s01.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s02.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s03.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s04.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s05.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s06.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s07.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s08.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s09.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s10.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s11.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s12.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s13.dta"
append using "C:\Users\Antoine\Desktop\DEPP\s14.dta"

## Sauvegarde

save "C:\Users\Antoine\Desktop\DEPP\depp.dta"

## Renommage des variables

ren originesocialedtaille pcs8
ren pcs8 pcs24
ren originesociale8groupes pcs8
ren franaistranger natio
ren sriedubaccalauratlibc serie
ren numrodtablissement numetan
ren numetan numetab
ren communeetarrondissement com
ren secteurdenseignement secteur
ren etablissementsensible sensible
ren nombredinscrits inscrits
ren nombredeprsents presents
ren nombretotaldadmis admis
ren nombredadmissansmention nomention
ren nombredadmismentionab ab
ren nombredadmismentionb b
ren nombredadmismentiontb tb
ren nombredtablissements nbetab

## Id Unique Lycée x Session 

egen id_etab = concat(numetab session), punct(_)


## Compteur des résultats

gen num = 1

bysort id_etab : egen  pond_admis = total(admis)
bysort id_etab : egen  pond_inscrits = total(inscrits)
bysort id_etab : egen  pond_presents = total(presents)
bysort id_etab : egen  pond_nomention = total(nomention)
bysort id_etab : egen  pond_ab = total(ab)
bysort id_etab : egen  pond_b = total(b)
bysort id_etab : egen  pond_tb = total(tb)

order pond_inscrits pond_presents, after( num )

## Taux de réussite et mention

gen psucc = ( pond_admis / pond_inscrits ) * 100
gen nm_adm = ( pond_nomention / pond_admis ) * 100
gen ab_adm = ( pond_ab / pond_admis ) * 100
gen b_adm = ( pond_b / pond_admis ) * 100
gen tb_adm = ( pond_tb / pond_admis ) * 100

## Gestion des valeurs manquantes

replace nm_adm = 0 if nm_adm == .
replace ab_adm = 0 if ab_adm == .
replace b_adm = 0 if b_adm == .
replace tb_adm = 0 if tb_adm == .

## TODO : PCS
